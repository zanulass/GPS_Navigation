============================================================================
　　　　　「GPSのための実用プログラミング」　収録ファイルのご案内
============================================================================


　このreadme.txtファイルと共に提供されているファイルは，「GPSのための実用プ
ログラミング」（坂井丈泰著，東京電機大学出版局刊，ISBN978-4-501-32550-3）に
掲載されているプログラム例および関連するデータファイルです．本書読者の便利の
ために電子ファイルとして提供するものですので，詳しい解説は本書をご参照くださ
い．

　収録ファイルは，インターネットからダウンロードできます．次のアドレスをご利
用ください．

　　　　東京電機大学出版局ウェブページ　http://www.tdupress.jp/

　収録ファイルの簡単な説明を以下に記します．末尾に利用上の注意を付してありま
すので，あわせてご参照ください．

１．実用プログラム

（１）測位計算プログラム

・「pos1.c」
　リスト5.2のプログラムを，省略せずに収録したものです．お手持ちのCコンパイラ
でコンパイル・実行できます．

・「pos1.exe」
　pos1.cを，Microsoft Visual C++を使用してコンパイルした実行ファイルです．
ウィンドウズのコマンドプロンプト画面で実行できます．引数なしで実行すると，
簡単な使い方が表示されます．なお，「pos1.obj」はコンパイルの過程で生成される
オブジェクトファイルです（他の*.objファイルも同様）．

・「pos1wgt.c」
　6.2節「重み付きの計算」で説明した計算方法に従い，pos1.cを修正したもので
す．GPS衛星の仰角により重みを付けて測位計算を行うことができます．

・「pos1wgt.exe」
　pos1wgt.cをコンパイルし，実行形式にしたファイルです．

・「pos2.c」
　本書で最後に紹介した測位計算プログラム（リスト6.2）です．本書で解説したす
べての計算方法を含み，もっとも実用的といるプログラムです．ディファレンシャル
GPSのためのリスト7.1も含まれています．

・「pos2.exe」
　pos2.cをコンパイルし，実行形式にしたファイルです．pos1.exeやpos1wgt.exeと
同様，ウィンドウズのコマンドプロンプト画面で実行できます．

（２）ユーティリティプログラム

「stat.c」「stat.exe」
　本書で紹介した統計処理プログラム（リスト7.2）です．pos1.c等による計算結果
を処理して，統計情報を得ることができます．利用法については本書7.5節を参照し
てください．

・「xyz2blh.c」「xyz2blh.exe」
　本書では紙面の都合で紹介していませんが，座標変換を行うプログラムをユーティ
リティとして用意しました．プログラムxyz2blh.c（もちろんコンパイルする必要が
あります）にpos1.c等による計算結果（ECEF座標）を入力すると，座標値が経緯度に
変換されて出力されます．入出力ファイルはいずれもテキスト形式で，各行のフォー
マットを整理すると次のとおりです．

入力ファイル：
<時刻[s]>, <X座標[m]>, <Y座標[m]>, <Z座標[m]>...

出力ファイル：
<時刻[s]>, <緯度[deg]>, <経度[deg]>, <高度[m]>...

　入出力には標準入出力を用いますので，たとえば次のようにすると，ECEF座標値に
よる座標データファイル「mtka318.pos」から，経緯度によるファイル
「mtka318.blh」を作成することができます．

xyz2blh <mtka318.pos >mtka318.blh

・「blh2xyz.c」「blh2xyz.exe」
　xyz2blh.cとは反対に，経緯度で記述された座標値を，ECEF直交座標系に変換する
ためのプログラムです．

・「xyz2enu.c」「xyz2enu.exe」
　ECEF座標系による座標値を，指定された原点から見たENU座標値に変換するプログ
ラムです．ENU座標系については，2.3節「座標変換」を参照してください．このプロ
グラムにより，東西方向や南北方向の測位誤差を求めることができます．

　このプログラムでは原点の位置を指定する必要があり，次のように実行します．

xyz2enu 緯度[deg] 経度[deg] 高度[deg] <入力ファイル >出力ファイル

　たとえば次のようにすると，ECEF座標値による座標データファイル
「mtka318.pos」を入力として，IGSサイトmtkaのアンテナ位置を原点とするENU座標
値に変換し，測位誤差を得ることができます．

xyz2blh 35.679514962 139.561384732 109.0133 <mtka318.pos >mtka318.off

２．その他の書籍掲載プログラム

・「test1.c」「test1.exe」
　「測位計算（第1段階）」のプログラム（リスト2.18）です．測位計算のもっとも
基本的な部分をプログラムにしたもので，受信機クロック誤差はまだ未知数にされて
いません．このプログラムを実行した結果の例が「test1.out」です．

・「test2.c」「test2.exe」
　「測位計算（第2段階）」のプログラム（リスト3.8）です．受信機クロック誤差が
未知数となり，航法メッセージから衛星位置を計算するようになりました．実行結果
は，「test2.out」のとおりとなります．

・「test3.c」「test3.exe」
　「測位計算（第3段階）」のプログラム（リスト4.5）です．擬似距離による測位計
算の基本的なアルゴリズムはすべて含まれています．「test3.out」は，このプログ
ラムの実行結果です．

・「test3enu.c」「test3enu.exe」
　4.7節で述べるとおり，test3.cの測位計算部分はENU座標系を用いて記述すること
もできます．test3.cに対してこの修正をしたものが本リストです．実行結果は
「test3enu.out」のとおりで，「test3.out」とまったく同一の結果が得られること
がわかります．

・「masksats.c」「masksats.exe」
　利用者がいる地点を指定して，衛星の見え具合を計算するプログラム（リスト
6.1）です．図6-2の作成に使用しました．

３．データおよび計算結果など

（１）IGS観測データ

・「mtka3180.05n」
　IGSサイトmtka（東京都調布市）が受信した航法メッセージを納めたRINEX航法ファ
イルで，2005年11月14日のものです．

・「mtka3180.05o」
　同じくIGSサイトmtkaによるRINEX観測データファイルで，2005年11月14日のもので
す．使用されている受信機はAshtech社のZ-18で，エポック間隔は30秒です．GLONASS
の観測データも含まれています．

（２）計算結果

・「mtka318.pos」「mtka318.off」「mtka318.gga」
　pos1.cによる測位計算結果で，観測データとしてはいずれもmtka3180.05oを利用し
ています．計算結果はそれぞれ，ECEF座標値，IGSサイトmtkaのアンテナ位置を原点
とするENU座標値（以下の*.offファイルも同様），あるいはNMEAフォーマットの
GPGGA形式として出力されています．

・「mtka318.sta」
　stat.cを用いて，mtka318.offの統計処理をした結果です（以下の*.staファイルも
同様）．

・「mtka318w.off」「mtka318w.sta」
　pos1wgt.cによる計算結果です．

・「mtka318_pos2.off」「mtka318_pos2.sta」
　pos2.cによる計算結果です．

・「mtka318h.off」「mtka318h.sta」
　pos2.cを用いて，「-h」オプションを付けることで高度を固定して得た計算結果で
す．高度方向のENU座標値がほぼゼロになっています．

・「mtka318l.off」「mtka318l.sta」
　同様に，pos2.cを用いて，「-l」オプションを付けることで方向を固定して得た計
算結果です．方位角30度方向にしか解が変化しない様子は，グラフを作成するとよく
わかります．

・「mtka318.dif」
　mtka3180.05oから作成したディファレンシャル補正情報で，pos2.cに「-d」オプ
ションを付けて計算したものです．

・「mtka318d.off」「mtka318d.sta」
　ディファレンシャル補正情報mtka318.difを用いて，mtka3180.05oをpos2.cにより
処理した結果です．観測データはディファレンシャル補正情報を作成するのに使った
ものとまったく同じですから，補正して得た座標値に含まれる測位誤差は常にゼロと
なります（本書215ページを参照）．

・「tskb318d.off」「tskb318d.sta」
　ディファレンシャル補正情報mtka318.difを用いて，IGSサイトtskb（茨城県つくば
市の国土地理院にあります）の観測データtskb3180.05oに対して補正処理を行った結
果です．単独測位に比べて測位精度が大きく改善されている様子がわかります．

４．利用上の注意など

　書籍中でもご案内しておりますとおり，本書掲載のプログラム例につきましては読
者により自由に利用（電子的利用を含む）していただいて結構です．ただし，利用の
際には，修正の有無に関わらず本書を出典として明示してください．また，ご利用は
すべて利用する読者ご自身の責任で行うものとします．本書のプログラム例の利用に
よって生じるいかなる結果についても著者および出版者は何らの責任も負いません．

　収録ファイルのうちの実行ファイルについては，いずれも次のコンパイラ製品を使
用して作成したものです．ウィンドウズのコマンドプロンプト画面で実行できます．

Microsoft Visual C++ (R) 6.0
Copyright (c) 1994-98 Microsoft Corporation

Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 12.00.8168 for 80x86
Copyright (C) Microsoft Corp 1984-1998. All rights reserved.

　プログラムの誤りに気付かれた場合は，出版局までお知らせいただけますと幸いで
す．電子メールの場合は，info@tdupress.jp までお願いします．

５．更新履歴

2007.7.21   read_RINEX_NAV()関数のバグを修正．
            110行目末尾のセミコロンを削除しました．

以上
